version: 2

sources:
  - name: amber
    meta:
      external_location: "C:\\Users\\DanielLawson\\IdeaProjects\\powerboard\\data\\amber_{name}.csv"
    tables:
      - name: credits
        columns:
          - name: nmi
            data_type: BIGINT
          - name: account_number
            data_type: CHARACTER VARYING(256)
          - name: effective_from
            data_type: DATE
          - name: effective_to
            data_type: DATE
          - name: date_applied
            data_type: DATE
          - name: invoice_applied
            data_type: CHARACTER VARYING(256)
          - name: type
            data_type: CHARACTER VARYING(256)
          - name: description
            data_type: CHARACTER VARYING(256)
          - name: amount_cents
            data_type: BIGINT
      - name: sites
        columns:
          - name: id
            data_type: CHARACTER VARYING(256)
          - name: name
            data_type: CHARACTER VARYING(256)
          - name: supply_address
            data_type: CHARACTER VARYING(256)
          - name: account_number
            data_type: CHARACTER VARYING(256)
          - name: nmi
            data_type: BIGINT
          - name: active_from
            data_type: DATE
      - name: subscription_fees
        columns:
          - name: fee_type
            data_type: CHARACTER VARYING(256)
          - name: monthly_fee
            data_type: BIGINT
          - name: effective_from
            data_type: DATE
          - name: effective_to
            data_type: DATE
      - name: usage
        meta:
          external_location: "read_csv_auto('C:\\Users\\DanielLawson\\IdeaProjects\\powerboard\\data\\amber-extract\\daily\\*.csv')"
        columns:
          - name: date
            data_type: DATE
          - name: nem_time_start
            data_type: TIMESTAMP
          - name: nem_time
            data_type: TIMESTAMP
          - name: start_time
            data_type: TIMESTAMPTZ
          - name: end_time
            data_type: TIMESTAMPTZ
          - name: site_id
            data_type: CHARACTER VARYING(256)
          - name: channel_type
            data_type: CHARACTER VARYING(256)
          - name: channel_identifier
            data_type: CHARACTER VARYING(256)
          - name: type
            data_type: CHARACTER VARYING(256)
          - name: duration
            data_type: CHARACTER VARYING(256)
          - name: descriptor
            data_type: CHARACTER VARYING(256)
          - name: spike_status
            data_type: CHARACTER VARYING(256)
          - name: quality
            data_type: CHARACTER VARYING(256)
          - name: kwh
            data_type: DOUBLE
          - name: per_kwh
            data_type: DOUBLE
          - name: cost
            data_type: DOUBLE
          - name: renewables
            data_type: DOUBLE
          - name: spot_per_kwh
            data_type: DOUBLE
  - name: vdo
    meta:
        external_location: "C:\\Users\\DanielLawson\\IdeaProjects\\powerboard\\data\\{name}.csv"
    tables:
    - name: vdo
      columns:
        - name: distribution_zone
          data_type: CHARACTER VARYING(256)
        - name: supply_charge_cents_e4
          data_type: BIGINT
        - name: usage_charge_structure
          data_type: CHARACTER VARYING(256)
        - name: usage_charge_kwh_e4
          data_type: BIGINT
        - name: controlled_load_kwh_e4
          data_type: BIGINT
        - name: effective_from
          data_type: DATE
        - name: effective_to
          data_type: DATE
